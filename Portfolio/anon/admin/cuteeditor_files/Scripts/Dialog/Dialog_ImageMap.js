var OxO71a9=["contains","parentNode","selection","document","type","None","Text","body","rangeCount","window","Control","anchorOffset","childNodes","anchorNode","isCollapsed","focusNode","length","nodeType","nodeName","INPUT","TEXTAREA","BUTTON","IMG","SELECT","TABLE","position","style","absolute","relative","top","contentWindow","contentDocument","parentWindow","id","frames","frameElement","//TODO:frame contentWindow not found?","iframe","editor","img","onload","src","","src_cetemp","contentEditable","designMode","on","clearAttributes","marginTop","0","marginLeft","color","black","background","white","unselectable","2D-Position","LiveResize","innerHTML","outerHTML","MAP","name","useMap","#","areas","href","target","alt","coords",",","\x3Cimg id=\x27myIMAGE","\x27 border=1 src=\x27Images/space.gif\x27 title=\x27","\x27 style=\x27position:absolute;left:","px;top:","px;width:","px;height:","px;z-index:","\x27\x3E","MapLink.php","dialogWidth:350px;dialogHeight:200px;help:no;scroll:no;status:no;resizable:0;","zoom","width","height","\x27  border=1 src=\x27Images/space.gif\x27 title=\x27","\x27 style=\x27position:absolute;z-index:",";width:20;height:20;left:",";top:","myIMAGE","\x3Carea shape=\x27rect\x27 coords=\x27","\x27","href=\x27","\x27 ","target=\x27","alt=\x27","\x3E","PasteHTML","\x3Cmap name=\x27","\x3C/map\x3E","off","AutoMap","display","img_zoom_in","none","img_zoom_out","img_bestfit","img_actualsize"];function Element_Contains(element,Ox29f){if(!Browser_IsOpera()){if(element[OxO71a9[0]]){return element.contains(Ox29f);} ;} ;for(;Ox29f!=null;Ox29f=Ox29f[OxO71a9[1]]){if(element==Ox29f){return true;} ;} ;return false;} ;function Window_CreateSelectionRange(Ox2c6){var Ox345;if(Browser_UseIESelection()){var Ox25c=Ox2c6[OxO71a9[3]][OxO71a9[2]];if(Ox25c[OxO71a9[4]]==OxO71a9[5]||Ox25c[OxO71a9[4]]==OxO71a9[6]){Ox345=Ox25c.createRange();} else {Ox345=document[OxO71a9[7]].createTextRange();Ox345.moveToElement(Ox25c.createRange().item(0));} ;} else {var Ox25c=Ox2c6.getSelection();if(Ox25c[OxO71a9[8]]==0){Ox345=Ox2c6[OxO71a9[3]].createRange();} else {Ox345=Ox25c.getRangeAt(0).cloneRange();} ;} ;Ox345[OxO71a9[9]]=Ox2c6;return Ox345;} ;function Window_GetSelectionNode(Ox2c6){var Ox29f=Window_GetSelectionNode_Core(Ox2c6);if(Ox29f==Ox2c6[OxO71a9[3]][OxO71a9[7]]){return null;} ;if(!Element_Contains(Ox2c6[OxO71a9[3]].body,Ox29f)){return null;} ;return Ox29f;} ;function Window_GetSelectionNode_Core(Ox2c6){var Ox25c;if(Browser_UseIESelection()){Ox25c=Ox2c6[OxO71a9[3]][OxO71a9[2]];if(Ox25c[OxO71a9[4]]==OxO71a9[5]||Ox25c[OxO71a9[4]]==OxO71a9[6]){return Ox25c.createRange().parentElement();} ;return Ox25c.createRange().item(0);} ;var Ox25c=Ox2c6.getSelection();if(Window_GetSelectionType(Ox2c6)==OxO71a9[10]){return Ox25c[OxO71a9[13]][OxO71a9[12]][Ox25c[OxO71a9[11]]];} ;if(Ox25c[OxO71a9[14]]){return Ox25c[OxO71a9[13]];} ;if(Ox25c[OxO71a9[13]]==Ox25c[OxO71a9[15]]){return Ox25c[OxO71a9[13]];} ;var p=Ox25c[OxO71a9[13]];var Oxf=p[OxO71a9[12]];for(var i=0;i<Oxf[OxO71a9[16]];i++){var Ox365=Oxf.item(i);if(Ox25c.containsNode(Ox365,true)){if(i!=0&&Ox25c.containsNode(Oxf.item(i-1),false)){continue ;} ;if(i<Oxf[OxO71a9[16]]-1&&Ox25c.containsNode(Oxf.item(i+1),false)){continue ;} ;return Ox365;} ;} ;if(Ox25c[OxO71a9[8]]==1){return Range_GetParentNode(Window_CreateSelectionRange(Ox2c6));} ;if(!Element_Contains(Ox2c6[OxO71a9[3]].body,Ox25c.anchorNode)){return null;} ;return Element_GetSameParent(Ox25c.anchorNode,Ox25c.focusNode);} ;function Window_GetSelectionElement(Ox2c6){var Ox29f=Window_GetSelectionNode(Ox2c6);if(Ox29f==null){return null;} ;if(Ox29f[OxO71a9[17]]==1){return Ox29f;} ;return Ox29f[OxO71a9[1]];} ;function Window_GetSelectionType(Ox2c6){if(Browser_UseIESelection()){return Ox2c6[OxO71a9[3]][OxO71a9[2]][OxO71a9[4]];} ;var Ox25c=Ox2c6.getSelection();if(Ox25c[OxO71a9[14]]){return OxO71a9[6];} ;if(Ox25c[OxO71a9[13]]!=Ox25c[OxO71a9[15]]){return OxO71a9[6];} ;var p=Ox25c[OxO71a9[13]];var Oxf=p[OxO71a9[12]];for(var i=0;i<Oxf[OxO71a9[16]];i++){var Ox365=Oxf.item(i);if(Ox365[OxO71a9[17]]!=1){continue ;} ;if(Ox25c.containsNode(Ox365,true)){if(i!=0&&Ox25c.containsNode(Oxf.item(i-1),false)){continue ;} ;if(i<Oxf[OxO71a9[16]]-1&&Ox25c.containsNode(Oxf.item(i+1),false)){continue ;} ;if(Element_IsBlockControl(Ox365)){return OxO71a9[10];} ;return OxO71a9[6];} ;} ;return OxO71a9[6];} ;function Element_IsBlockControl(element){var name=element[OxO71a9[18]];if(name==OxO71a9[19]){return true;} ;if(name==OxO71a9[20]){return true;} ;if(name==OxO71a9[21]){return true;} ;if(name==OxO71a9[22]){return true;} ;if(name==OxO71a9[23]){return true;} ;if(name==OxO71a9[24]){return true;} ;var Ox22b=element[OxO71a9[26]][OxO71a9[25]];if(Ox22b==OxO71a9[27]||Ox22b==OxO71a9[28]){return true;} ;return false;} ;function Window_GetDialogTop(Ox2c6){return Ox2c6[OxO71a9[29]];} ;function Frame_GetContentWindow(Ox469){if(Ox469[OxO71a9[30]]){return Ox469[OxO71a9[30]];} ;if(Ox469[OxO71a9[31]]){if(Ox469[OxO71a9[31]][OxO71a9[32]]){return Ox469[OxO71a9[31]][OxO71a9[32]];} ;} ;var Ox2c6;if(Ox469[OxO71a9[33]]){Ox2c6=window[OxO71a9[34]][Ox469[OxO71a9[33]]];if(Ox2c6){return Ox2c6;} ;} ;var len=window[OxO71a9[34]][OxO71a9[16]];for(var i=0;i<len;i++){Ox2c6=window[OxO71a9[34]][i];if(Ox2c6[OxO71a9[35]]==Ox469){return Ox2c6;} ;if(Ox2c6[OxO71a9[3]]==Ox469[OxO71a9[31]]){return Ox2c6;} ;} ;Debug_Todo(OxO71a9[36]);} ;var iframe=Window_GetElement(window,OxO71a9[37],true);var iframe_win=Frame_GetContentWindow(iframe);var obj=Window_GetDialogArguments(window);var editor=obj[OxO71a9[38]];var editwin=obj[OxO71a9[9]];var editdoc=obj[OxO71a9[3]];var oImg=obj[OxO71a9[39]];var oMap=null;var aMapName= new Array();var aLeft= new Array();var aTop= new Array();var aWidth= new Array();var aHeight= new Array();var aHref= new Array();var aTarget= new Array();var aTitle= new Array();var aCoords= new Array();window[OxO71a9[40]]=function window_onload(){var src;src=oImg.getAttribute(OxO71a9[41])+OxO71a9[42];if(oImg.getAttribute(OxO71a9[43])){src=oImg.getAttribute(OxO71a9[43])+OxO71a9[42];} ;oImg[OxO71a9[41]]=src;if(Browser_IsWinIE()){iframe_win[OxO71a9[3]][OxO71a9[7]][OxO71a9[44]]=true;} else {iframe_win[OxO71a9[3]][OxO71a9[45]]=OxO71a9[46];iframe_win[OxO71a9[3]][OxO71a9[7]][OxO71a9[44]]=true;} ;iframe_win[OxO71a9[3]][OxO71a9[7]][OxO71a9[47]];iframe_win[OxO71a9[3]][OxO71a9[7]][OxO71a9[26]][OxO71a9[48]]=OxO71a9[49];iframe_win[OxO71a9[3]][OxO71a9[7]][OxO71a9[26]][OxO71a9[50]]=OxO71a9[49];iframe_win[OxO71a9[3]][OxO71a9[7]][OxO71a9[26]][OxO71a9[51]]=OxO71a9[52];iframe_win[OxO71a9[3]][OxO71a9[7]][OxO71a9[26]][OxO71a9[53]]=OxO71a9[54];oImg[OxO71a9[55]]=OxO71a9[46];if(Browser_IsWinIE()){iframe_win[OxO71a9[3]].execCommand(OxO71a9[56],true,true);iframe_win[OxO71a9[3]].execCommand(OxO71a9[57],true,true);} ;iframe_win.focus();if(Browser_IsWinIE()){iframe_win[OxO71a9[3]][OxO71a9[7]][OxO71a9[58]]=oImg[OxO71a9[59]];} else {iframe_win[OxO71a9[3]][OxO71a9[7]][OxO71a9[58]]=outerHTML(oImg);} ;var Ox477=editdoc[OxO71a9[7]].getElementsByTagName(OxO71a9[60]);for(var i=0;i<Ox477[OxO71a9[16]];i++){aMapName[i]=Ox477[i][OxO71a9[61]].toUpperCase();} ;var Ox478=oImg[OxO71a9[62]];if(Ox478!=OxO71a9[42]){Ox478=Ox478.toUpperCase();for(var i=0;i<Ox477[OxO71a9[16]];i++){if((OxO71a9[63]+aMapName[i])==Ox478){oMap=Ox477[i];} ;} ;} ;if(oMap){for(var i=0;i<oMap[OxO71a9[64]][OxO71a9[16]];i++){aHref[i]=oMap[OxO71a9[64]][i][OxO71a9[65]];aTarget[i]=oMap[OxO71a9[64]][i][OxO71a9[66]];aTitle[i]=oMap[OxO71a9[64]][i][OxO71a9[67]];aCoords[i]=oMap[OxO71a9[64]][i][OxO71a9[68]];var Ox1e=aCoords[i].split(OxO71a9[69]);aLeft[i]=parseInt(Ox1e[0]);aTop[i]=parseInt(Ox1e[1]);aWidth[i]=parseInt(Ox1e[2])-aLeft[i];aHeight[i]=parseInt(Ox1e[3])-aTop[i];iframe_win[OxO71a9[3]][OxO71a9[7]][OxO71a9[58]]+=OxO71a9[70]+i+OxO71a9[71]+AddLinktoImageMap+OxO71a9[72]+aLeft[i]+OxO71a9[73]+aTop[i]+OxO71a9[74]+aWidth[i]+OxO71a9[75]+aHeight[i]+OxO71a9[76]+(i+1)+OxO71a9[77];} ;} ;} ;function SearchSelectionElement(Ox47a){var body=iframe_win[OxO71a9[3]][OxO71a9[7]];for(var Ox275=Window_GetSelectionElement(iframe_win);Element_Contains(body,Ox275);Ox275=Ox275[OxO71a9[1]]){if(Ox275[OxO71a9[18]]==Ox47a){return Ox275;} ;} ;return null;} ;function Addlink(){var img=SearchSelectionElement(OxO71a9[22]);if(!img){return ;} ;function Ox47e(arr){if(arr){aHref[Ox480]=arr[0];aTarget[Ox480]=arr[1];aTitle[Ox480]=arr[2];} ;} ;var Ox47f=img[OxO71a9[33]];var Ox480=parseInt(Ox47f.substr(7));var obj={editor:editor,href:aHref[Ox480],target:aTarget[Ox480],title:aTitle[Ox480]};editor.SetNextDialogWindow(window);editor.ShowDialog(Ox47e,OxO71a9[78]+query_string,obj,OxO71a9[79]);} ;function do_Close(){Window_SetDialogReturnValue(window,null);Window_CloseDialog(window);} ;function Zoom_In(){if(iframe_win[OxO71a9[3]][OxO71a9[7]][OxO71a9[26]][OxO71a9[80]]!=0){iframe_win[OxO71a9[3]][OxO71a9[7]][OxO71a9[26]][OxO71a9[80]]*=1.2;} else {iframe_win[OxO71a9[3]][OxO71a9[7]][OxO71a9[26]][OxO71a9[80]]=1.2;} ;} ;function Zoom_Out(){if(iframe_win[OxO71a9[3]][OxO71a9[7]][OxO71a9[26]][OxO71a9[80]]!=0){iframe_win[OxO71a9[3]][OxO71a9[7]][OxO71a9[26]][OxO71a9[80]]*=0.8;} else {iframe_win[OxO71a9[3]][OxO71a9[7]][OxO71a9[26]][OxO71a9[80]]=0.8;} ;} ;function BestFit(){if(!oImg){return ;} ;var Ox484=280;var Ox26f=290;iframe_win[OxO71a9[3]][OxO71a9[7]][OxO71a9[26]][OxO71a9[80]]=1/Math.max(oImg[OxO71a9[81]]/Ox26f,oImg[OxO71a9[82]]/Ox484);} ;function Actualsize(){iframe_win[OxO71a9[3]][OxO71a9[7]][OxO71a9[26]][OxO71a9[80]]=1;} ;function newMap(){var Ox23a=aHref[OxO71a9[16]];var Ox487=(oImg[OxO71a9[81]]-20)*0.5;var Ox45b=(oImg[OxO71a9[82]]-20)*0.5;aHref[Ox23a]=OxO71a9[42];aTarget[Ox23a]=OxO71a9[42];aTitle[Ox23a]=OxO71a9[42];iframe_win[OxO71a9[3]][OxO71a9[7]][OxO71a9[58]]+=OxO71a9[70]+Ox23a+OxO71a9[83]+AddLinktoImageMap+OxO71a9[84]+(Ox23a+1)+OxO71a9[85]+Ox487+OxO71a9[86]+Ox45b+OxO71a9[77];iframe_win.scrollBy(0,0);iframe_win.focus();} ;function do_insert(){var Ox1f=false;for(var i=0;i<aHref[OxO71a9[16]];i++){var obj=Window_GetElement(iframe_win,OxO71a9[87]+i,false);if(obj){Ox1f=true;} ;} ;if(Ox1f){var Ox3a4=OxO71a9[42];for(var i=0;i<aHref[OxO71a9[16]];i++){var obj=Window_GetElement(iframe_win,OxO71a9[87]+i,false);if(obj){var Ox488=parseInt(obj[OxO71a9[26]].left);var Ox489=parseInt(obj[OxO71a9[26]].top);var Ox48a=parseInt(obj[OxO71a9[26]].width);var Ox48b=parseInt(obj[OxO71a9[26]].height);var Ox48c=Ox488+Ox48a;var Ox48d=Ox489+Ox48b;Ox3a4+=OxO71a9[88]+Ox488+OxO71a9[69]+Ox489+OxO71a9[69]+Ox48c+OxO71a9[69]+Ox48d+OxO71a9[89];if(aHref[i]!=OxO71a9[42]){Ox3a4+=OxO71a9[90]+aHref[i]+OxO71a9[91];} ;if((aTarget[i]!=OxO71a9[42])&&aTarget[i]){Ox3a4+=OxO71a9[92]+aTarget[i]+OxO71a9[91];} ;if(aTitle[i]!=OxO71a9[42]&&aTitle[i]!=null){Ox3a4+=OxO71a9[93]+aTitle[i]+OxO71a9[91];} ;Ox3a4+=OxO71a9[94];} ;} ;if(oMap){oMap[OxO71a9[58]]=Ox3a4;} else {var Ox478=getAutoMapName();oImg[OxO71a9[62]]=OxO71a9[63]+Ox478;editor.ExecCommand(OxO71a9[95],false,OxO71a9[96]+Ox478+OxO71a9[77]+Ox3a4+OxO71a9[97]);} ;} else {if(oMap){if(Browser_IsWinIE()){oMap[OxO71a9[59]]=OxO71a9[42];} ;} ;oImg[OxO71a9[62]]=OxO71a9[42];} ;oImg[OxO71a9[55]]=OxO71a9[98];oImg.removeAttribute(OxO71a9[55]);if(!Browser_IsWinIE()){editor.InsertElement(oImg);} ;Window_CloseDialog(window);} ;function getAutoMapName(){for(var i=1;true;i++){var Ox1f1=OxO71a9[99]+i;if(isValidMapName(Ox1f1)){return Ox1f1;} ;} ;} ;function isValidMapName(Oxe){Oxe=Oxe.toUpperCase();for(var i=0;i<aMapName[OxO71a9[16]];i++){if(aMapName[i]==Oxe){return false;} ;} ;return true;} ;function do_Close(){oImg.removeAttribute(OxO71a9[55]);Window_CloseDialog(window);} ;if(!Browser_IsWinIE()){Window_GetElement(window,OxO71a9[101],true)[OxO71a9[26]][OxO71a9[100]]=OxO71a9[102];Window_GetElement(window,OxO71a9[103],true)[OxO71a9[26]][OxO71a9[100]]=OxO71a9[102];Window_GetElement(window,OxO71a9[104],true)[OxO71a9[26]][OxO71a9[100]]=OxO71a9[102];Window_GetElement(window,OxO71a9[105],true)[OxO71a9[26]][OxO71a9[100]]=OxO71a9[102];} ;